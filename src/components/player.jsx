import React from 'react'
import axios from 'axios'
import { useCreateContext } from '../utils/provider'
import { reducerCases } from '../utils/constant'
import { useEffect } from 'react'

const Player = () => {
const [{token, currentPlaying},dispatch] = useCreateContext()

// useEffect(()=> {
//   getPlaying()
// },[token,dispatch])

// const getPlaying = async () => {

//   // const { data } = await axios.get("https://api.spotify.com/v1/me/player/currently-playing",{
//   //   headers:{
//   //     'Authorization': 'Bearer ' + token,
//   //     "Content-Type": "application/json",
//   //   }
//   // })

//   const config = {
//     headers:{
//       'Authorization': 'Bearer ' + token,
//       "Content-Type": "application/json",
//     }
//   }

//   const [res1, res2] =  await axios.all([
//       // axios.get("https://api.spotify.com/v1/me/player/currently-playing",config),
//       axios.get("https://api.spotify.com/v1/me/player",config),
//   ])

//   // console.log(res1)
//   // console.log(res2,"awkaowkow")

//   const playingInfo = {
//     name: res1.data.item.name,
//     images: res1.data.item.album.images,
//     artist: res1.data.item.artists[0].name,
//     duration: res1.data.item.duration_ms,
//     progress: res1.data.progress_ms,
//   }
 
//   dispatch({type:reducerCases.SET_PLAYING, playingInfo})
  
// }

// // setInterval(getPlaying,10000)
// if(currentPlaying?.progress === currentPlaying?.duration){
//   getPlaying()
//  }


 useEffect(() => {
      const getPlaying = async () => {

        // const { data } = await axios.get("https://api.spotify.com/v1/me/player/currently-playing",{
        //   headers:{
        //     'Authorization': 'Bearer ' + token,
        //     "Content-Type": "application/json",
        //   }
        // })

        const config = {
          headers:{
            'Authorization': 'Bearer ' + token,
            "Content-Type": "application/json",
          }
        }

        const [res1, res2] =  await axios.all([
            // axios.get("https://api.spotify.com/v1/me/player/currently-playing",config),
            axios.get("https://api.spotify.com/v1/me/player",config),
        ])
      
        // console.log(res1)
        // console.log(res2,"awkaowkow")

        const playingInfo = {
          name: res1.data.item.name,
          images: res1.data.item.album.images,
          artist: res1.data.item.artists.map(item => item.name),
          duration: res1.data.item.duration_ms,
          progress: res1.data.progress_ms,
        }
       
        dispatch({type:reducerCases.SET_PLAYING, playingInfo})
      }
      getPlaying()
      // const intervalId = setInterval(getPlaying, 1 * 60 * 1000);

      // // Clean up the interval when the component unmounts
      // return () => getPlaying(intervalId);
  },[ token,dispatch])

  // console.log(currentPlaying?.duration)
  // console.log(currentPlaying?.progress,"progress")
// const change = () => {     
//   if(currentPlaying?.progress === currentPlaying?.duration){
//    console.log("kontol")
//   }
// }
const ms = currentPlaying?.duration
const minutes = Math.floor(ms / 60000)
const seconds = ((ms % 60000)/ 1000).toFixed(0)

  return (
    <div className='h-24 fixed bottom-0 bg-[#181818] w-screen p-3'>
      <div className='  h-full flex justify-center'>

        <div className=' h-full w-1/3 flex flex-row  p-2 float-left'>
          <div 
          style={{backgroundImage: `url(${currentPlaying?.images[0].url})`}}
          className='bg-white w-[60px] h-full bg-cover bg-center '></div>
            <div className='flex-col flex font-spotifylight ml-4 justify-center text-white '>
               <span className='font-spotifylight text-[13px]'>{currentPlaying?.name}</span>
               <span className=' text-[12px] font-spotifylight text-[#B3B3B3]  '>{currentPlaying?.artist.join(", ")}</span>
            </div>
            <div className=' flex items-center ml-4 '>
           
            <svg  className='h-4 w-4' viewBox="0 0 59 54" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5.32068 28.3355C5.32068 28.3355 20.5889 45.7575 25.742 51.6003C26.6008 52.6692 28.0322 53.2862 29.4636 53.2862C30.9904 53.2862 32.3264 52.6692 33.2806 51.6003C37.1931 47.1259 47.3083 35.6872 53.7019 28.3355C57.9007 23.5244 59.2367 16.9567 57.0418 11.0404C55.515 6.9535 52.2705 3.67325 48.0718 2.02904C43.873 0.384832 39.1017 0.534554 34.9983 2.43918L29.4636 4.99988L24.0243 2.43918C19.9209 0.534554 15.1496 0.384832 10.9508 2.02904C6.75208 3.67325 3.50758 6.9535 1.98076 11.0404C-0.214053 16.9567 1.02649 23.5244 5.32068 28.3355ZM29.9407 47.1422C29.8453 47.2702 29.6544 47.3445 29.4636 47.3445C29.3682 47.3445 29.1773 47.2702 29.0819 47.1422C26.0282 43.7613 9.51945 24.9418 9.51945 24.9418C6.56123 21.5608 5.70239 16.9449 7.22921 12.7863C8.18348 10.1285 10.2829 7.99518 13.0502 6.92536C15.8176 5.85644 18.8712 5.95355 21.5432 7.19306C25.2648 8.9144 28.3185 10.3236 28.3185 10.3236C29.0819 10.6829 29.9407 10.6829 30.7041 10.3236L37.4794 7.19306C40.0559 5.95355 43.205 5.85644 45.9724 6.92536C48.6443 7.99518 50.8391 10.1285 51.7934 12.7863C53.3202 16.9449 52.4614 21.5608 49.4077 24.9418C49.4077 24.9418 32.8989 43.7613 29.9407 47.1422Z" 
fill="#B3B3B3"/>
</svg>


            </div>
        </div>


        <div className=' h-full   w-1/3  '>
          <div className='h-2/3  flex items-center justify-center '>

<svg className='h-6 w-6 m-2' viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.3395 15.4905C15.876 15.3443 15.2842 14.9633 14.622 14.3003C14.0535 13.7438 13.467 13.0268 12.867 12.2453C12.723 12.4365 12.5797 12.6278 12.4357 12.8228C12.0435 13.3538 11.6422 13.89 11.2335 14.4173C12.6615 16.1498 14.1435 17.8508 16.341 18.1313V20.1563L22.0072 16.8863L16.3402 13.614V15.4905H16.3395ZM6.89399 8.95053C7.46099 9.50553 8.04749 10.2225 8.64899 11.004C8.79449 10.8075 8.94149 10.614 9.08849 10.413C9.48032 9.8809 9.87835 9.35337 10.2825 8.83053C8.75849 6.98253 7.18274 5.15028 4.73549 5.06253H2.11049V7.68753H4.73549C5.22674 7.66728 5.99699 8.05128 6.89399 8.94978V8.95053ZM16.3395 7.75578V9.65778L22.0065 6.38553L16.3395 3.11328V5.09853C14.9115 5.26353 13.7707 6.10953 12.777 7.08153C11.1292 8.71953 9.68924 10.9575 8.26799 12.7365C6.86774 14.5643 5.46299 15.6518 4.73399 15.564H2.10899V18.189H4.73399C6.37274 18.1665 7.64399 17.2395 8.73899 16.1693C10.3845 14.5313 11.826 12.294 13.2465 10.5158C14.4037 9.00303 15.5595 8.01078 16.3395 7.75578Z" fill="#C4C4C4"/>
</svg>

<svg className='h-8 w-8 m-2 mr-0' viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20.6667 9.04163L11.625 15.5L20.6667 21.9583V9.04163ZM11.625 15.5V9.04163H9.04167V21.9583H11.625V15.5Z" fill="#C4C4C4"/>
</svg>

<svg className='h-12 w-12 m-2' viewBox="0 0 51 51" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M25.5 4.25C21.2971 4.25 17.1887 5.49629 13.6941 7.83127C10.1996 10.1663 7.47592 13.485 5.86755 17.368C4.25919 21.2509 3.83837 25.5236 4.65831 29.6457C5.47824 33.7678 7.50211 37.5542 10.474 40.526C13.4458 43.4979 17.2322 45.5218 21.3543 46.3417C25.4764 47.1616 29.7491 46.7408 33.632 45.1324C37.5149 43.5241 40.8337 40.8004 43.1687 37.3059C45.5037 33.8113 46.75 29.7029 46.75 25.5C46.75 22.7094 46.2003 19.9461 45.1324 17.368C44.0645 14.7898 42.4993 12.4472 40.526 10.474C38.5528 8.50074 36.2102 6.93547 33.632 5.86756C31.0539 4.79965 28.2906 4.25 25.5 4.25ZM21.3543 32.5V17.381L33 25.5L21.3543 32.5Z" fill="white"/>
</svg>

<svg  className='h-8 w-8 m-2 ml-0' viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.3333 9.04163L19.375 15.5L10.3333 21.9583V9.04163ZM19.375 15.5V9.04163H21.9583V21.9583H19.375V15.5Z" fill="#C4C4C4"/>
</svg>

<svg className='h-6 w-6 m-2' viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M18.15 7.33805C18.2776 7.33805 18.3953 7.38205 18.4888 7.45575L18.5625 7.52505L18.5812 7.54705C19.2203 8.33911 19.627 9.29297 19.7562 10.3025C19.8854 11.312 19.732 12.3375 19.313 13.265C18.894 14.1925 18.2259 14.9855 17.383 15.5559C16.5401 16.1262 15.5555 16.4515 14.5387 16.4955L14.3 16.4999H7.69999C7.58882 16.5 7.47767 16.4967 7.36669 16.49L9.18939 18.3105C9.28034 18.4017 9.33642 18.5218 9.34788 18.6501C9.35933 18.7783 9.32544 18.9065 9.25209 19.0123L9.18939 19.0893C9.09825 19.1803 8.97809 19.2364 8.84985 19.2478C8.72161 19.2593 8.59341 19.2254 8.48759 19.152L8.41059 19.0893L5.66059 16.3393C5.56965 16.2482 5.51356 16.128 5.50211 15.9998C5.49065 15.8716 5.52455 15.7434 5.59789 15.6375L5.66059 15.5605L8.41059 12.8105C8.5076 12.7131 8.63759 12.6555 8.77494 12.6492C8.91229 12.6428 9.04704 12.6881 9.15263 12.7762C9.25823 12.8643 9.32701 12.9887 9.34542 13.1249C9.36383 13.2612 9.33053 13.3994 9.25209 13.5123L9.18939 13.5893L7.38869 15.3889L7.54269 15.3977L7.69999 15.3999H14.3C15.1309 15.4 15.9449 15.1648 16.6477 14.7216C17.3505 14.2783 17.9134 13.6451 18.2713 12.8952C18.6292 12.1453 18.7675 11.3094 18.6701 10.4842C18.5727 9.65905 18.2436 8.8783 17.721 8.23235C17.6564 8.15147 17.616 8.05402 17.6043 7.95119C17.5926 7.84836 17.6102 7.74432 17.655 7.65102C17.6998 7.55773 17.77 7.47898 17.8576 7.42381C17.9451 7.36864 18.0465 7.33929 18.15 7.33915V7.33805ZM12.8106 2.91055C12.9017 2.8196 13.0219 2.76352 13.1501 2.75206C13.2784 2.7406 13.4066 2.7745 13.5124 2.84785L13.5894 2.91055L16.3394 5.66055L16.4021 5.73755C16.4655 5.82939 16.4994 5.93835 16.4994 6.04995C16.4994 6.16154 16.4655 6.2705 16.4021 6.36235L16.3394 6.43935L13.5894 9.18935L13.5124 9.25205C13.4205 9.31543 13.3116 9.34938 13.2 9.34938C13.0884 9.34938 12.9794 9.31543 12.8876 9.25205L12.8106 9.18935L12.7479 9.11235C12.6845 9.0205 12.6506 8.91154 12.6506 8.79995C12.6506 8.68835 12.6845 8.57939 12.7479 8.48755L12.8106 8.41055L14.6113 6.61095L14.4573 6.60215L14.3 6.59995H7.69999C6.86837 6.5999 6.05376 6.83553 5.35058 7.27953C4.6474 7.72353 4.08445 8.35772 3.72697 9.10859C3.36949 9.85947 3.23213 10.6963 3.33081 11.522C3.42948 12.3478 3.76015 13.1286 4.28449 13.7741C4.37216 13.891 4.40982 14.0379 4.38919 14.1825C4.36856 14.3271 4.29133 14.4576 4.17449 14.5452C4.11664 14.5887 4.0508 14.6202 3.98074 14.6382C3.91068 14.6562 3.83776 14.6602 3.76616 14.6499C3.62155 14.6293 3.49106 14.5521 3.40339 14.4352C2.76872 13.642 2.36617 12.6884 2.24036 11.6803C2.11456 10.6722 2.27043 9.64899 2.69068 8.72408C3.11093 7.79916 3.77914 7.00871 4.62122 6.44039C5.46329 5.87206 6.44632 5.54807 7.46129 5.50435L7.69999 5.49995H14.3C14.4122 5.49995 14.5233 5.50325 14.6333 5.50985L12.8106 3.68935L12.7479 3.61235C12.6745 3.50653 12.6406 3.37833 12.6521 3.25009C12.6636 3.12185 12.7196 3.00169 12.8106 2.91055Z" fill="#C4C4C4"/>
</svg>

          </div>

          <div className='h-1/3 text-white bs flex'>
              <div className='flex items-center mx-auto font-spotify'>
              <span className='mr-2'>0:00</span>
              <svg width="511" height="5" viewBox="0 0 511 5" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="511" height="5" rx="2.5" fill="#535353"/>
</svg>

           
           <span className='ml-2'>{minutes + ":" + (seconds < 10 ? '0' : '') + seconds}</span>
              </div>
 
          </div>
        
        </div>


        <div className=' h-full  flex   0 w-1/3 justify-end'>
       
<div className=' flex flex-row items-center   '>
 
  <svg  className='h-4 w-4  m-2 ' viewBox="0 0 57 55" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M25.4793 15.0376L2.53887 39.3014C-0.89648 42.922 -0.734106 48.466 2.88256 51.9051C6.50877 55.3532 12.3393 55.4985 16.1468 52.2409L41.6637 30.427C45.5762 30.4542 49.4507 29.0931 52.3135 26.3437C58.2299 20.736 58.0391 11.3626 51.7409 5.41914C45.5287 -0.515253 35.6708 -0.687658 29.7734 4.92007C26.882 7.66949 25.4506 11.3172 25.4793 15.0376ZM37.3218 27.5324L12.6921 48.5931C10.9267 50.0994 8.2166 50.0359 6.53709 48.4298C4.85759 46.8328 4.79124 44.2649 6.37532 42.5862C12.7403 35.8623 24.1057 23.8393 28.524 19.1662L37.3218 27.5324ZM42.4749 25.4907L30.6711 14.2663C30.8237 12.0976 31.7301 10.0105 33.4287 8.3953C37.3698 4.64774 43.9446 4.92903 48.1147 8.89437C52.3135 12.8597 52.5998 19.1208 48.6873 22.8683C46.9505 24.4744 44.7556 25.3455 42.4749 25.4907Z" 
fill="#B3B3B3"/>
</svg>

<svg className='h-4 w-4 m-2  '  viewBox="0 0 51 47" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M48.095 41.4707C48.095 41.2892 47.9421 41.1531 47.7513 41.1531C43.7911 41.1531 6.28846 41.1531 2.32826 41.1531C2.14695 41.1531 1.99426 41.2892 1.99426 41.4707C1.99426 42.4144 1.99426 45.1729 1.99426 46.1257C1.99426 46.2981 2.14695 46.4433 2.32826 46.4433C6.28846 46.4433 43.7911 46.4433 47.7513 46.4433C47.9421 46.4433 48.095 46.2981 48.095 46.1257V41.4707ZM48.095 27.0794C48.095 26.907 47.9421 26.7618 47.7513 26.7618C43.7911 26.7618 6.28846 26.7618 2.32826 26.7618C2.14695 26.7618 1.99426 26.907 1.99426 27.0794C1.99426 28.0321 1.99426 30.7907 1.99426 31.7344C1.99426 31.9068 2.14695 32.052 2.32826 32.052C6.28846 32.052 43.7911 32.052 47.7513 32.052C47.9421 32.052 48.095 31.9068 48.095 31.7344V27.0794ZM0 8.77719C0 4.18575 3.91249 0.465271 8.73152 0.465271H41.3957C46.2148 0.465271 50.175 4.18575 50.175 8.77719C50.175 13.3596 46.2148 17.0799 41.3957 17.0799H8.73152C3.91249 17.0799 0 13.3596 0 8.77719ZM5.56307 8.77719C5.56307 7.10757 6.98522 5.76452 8.73152 5.76452H41.3957C43.142 5.76452 44.5642 7.10757 44.5642 8.77719C44.5642 10.4377 43.142 11.7897 41.3957 11.7897H8.73152C6.98522 11.7897 5.56307 10.4377 5.56307 8.77719Z" 
fill="#B3B3B3"/>
</svg>

<svg  className='h-4 w-4 m-2  ' viewBox="0 0 59 50" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M9.93571 49.2968H14.6116V44.3786H7.3592V49.2968H9.93571ZM58.6032 6.71246C58.6032 3.40953 55.8359 0.732666 52.3051 0.732666H28.2576C24.7268 0.732666 21.9595 3.40953 21.9595 6.71246V43.2716C21.9595 46.5745 24.7268 49.2514 28.2576 49.2514H52.3051C55.8359 49.2514 58.6032 46.5745 58.6032 43.2716V6.71246ZM53.4502 6.71246V43.2716C53.4502 43.8614 52.9731 44.3422 52.3051 44.3422H28.2576C27.5896 44.3422 27.1125 43.8614 27.1125 43.2716V6.71246C27.1125 6.12265 27.5896 5.64166 28.2576 5.64166H52.3051C52.9731 5.64166 53.4502 6.12265 53.4502 6.71246ZM40.2813 25.0783C44.3847 25.0783 47.6292 28.2178 47.6292 32.0923C47.6292 35.9669 44.3847 39.1157 40.2813 39.1157C36.178 39.1157 32.9335 35.9669 32.9335 32.0923C32.9335 28.2178 36.178 25.0783 40.2813 25.0783ZM12.0351 0.732666H6.50036C2.96958 0.732666 0.202209 3.39138 0.202209 6.66709V29.2794C0.202209 32.5551 2.96958 35.2138 6.50036 35.2138H14.6116V30.3048H6.50036C5.83237 30.3048 5.35524 29.842 5.35524 29.2794V6.66709C5.35524 6.1045 5.83237 5.64166 6.50036 5.64166H14.6116V0.732666H12.0351ZM40.2813 10.9409C42.2853 10.9409 44.003 12.5107 44.003 14.4434C44.003 16.3853 42.2853 17.9552 40.2813 17.9552C38.2774 17.9552 36.5597 16.3853 36.5597 14.4434C36.5597 12.5107 38.2774 10.9409 40.2813 10.9409Z"
 fill="#B3B3B3"/>
</svg>


<svg className='h-4 w-4 m-2 mr-4 ' viewBox="0 0 58 55" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M0.30078 24.0088C-0.0236701 26.1412 -0.0045848 28.3189 0.348493 30.4694C0.882882 33.7632 2.95379 36.6397 5.98835 38.3184C14.3 42.9189 33.9863 53.8168 33.9863 53.8168C34.8547 54.2887 35.9144 54.2887 36.7828 53.8168C37.6416 53.345 38.1762 52.4738 38.1762 51.5301V2.64857C38.1762 1.70487 37.6416 0.824625 36.7828 0.352777C35.9144 -0.11907 34.8547 -0.119106 33.9863 0.361816C33.9863 0.361816 14.3 11.2507 5.98835 15.8512C2.95379 17.5299 0.882882 20.4154 0.348493 23.7093L0.30078 24.0088ZM42.7566 7.40337C42.7566 7.30356 42.8043 7.20368 42.8998 7.14923C42.9856 7.08571 43.0996 7.0766 43.195 7.1129C51.7261 10.1255 57.7952 17.9381 57.7952 27.0847C57.7952 36.2404 51.7261 44.0441 43.195 47.0658C43.0996 47.102 42.9856 47.0839 42.8998 47.0294C42.8139 46.9659 42.7566 46.8751 42.7566 46.7753C42.7566 45.6682 42.7566 42.8282 42.7566 41.8392C42.7566 41.6305 42.8805 41.4308 43.0809 41.3401C48.5107 38.6814 52.2322 33.2913 52.2322 27.0847C52.2322 20.8781 48.5107 15.4972 43.0809 12.8386C42.8805 12.7387 42.7566 12.5482 42.7566 12.3304C42.7566 11.3414 42.7566 8.50133 42.7566 7.40337ZM5.84521 24.544V24.5259C6.12195 22.8109 7.21026 21.3047 8.78479 20.4336L32.6026 7.24901C32.6026 7.24901 32.6026 40.9135 32.6026 46.2218C32.6026 46.367 32.5268 46.5031 32.3932 46.5757C32.2596 46.6483 32.107 46.6483 31.9734 46.5757C25.5989 43.0459 14.5008 36.9119 8.78479 33.7451C7.21026 32.874 6.12195 31.3677 5.84521 29.6527C5.56847 27.9559 5.56847 26.2228 5.84521 24.5259V24.544ZM42.7566 17.6297C42.7566 17.5027 42.833 17.3846 42.9475 17.3302C43.0715 17.2757 43.2145 17.2848 43.3195 17.3665C46.3636 19.6169 48.3294 23.1375 48.3294 27.0847C48.3294 31.041 46.3636 34.5527 43.3195 36.8121C43.2145 36.8847 43.0715 36.8937 42.9475 36.8393C42.833 36.7848 42.7566 36.6669 42.7566 36.549C42.7566 33.5001 42.7566 20.6786 42.7566 17.6297ZM0.30078 23.9996L0.339547 23.7273C0.330004 23.8181 0.310323 23.9088 0.30078 23.9996L0.186716 24.6984L0.30078 24.0088V23.9996Z" 
fill="#B3B3B3"/>
</svg>



<svg width="110" height="5"  viewBox="0 0 116 5" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="115" height="5" rx="2.5" fill="#C4C4C4"/>
</svg>


</div>


        </div>
      </div>
    </div>
  )
}

export default Player